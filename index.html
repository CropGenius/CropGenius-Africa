
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CropGenius - Agricultural Intelligence Platform</title>

  <link rel="icon" type="image/png" href="/lovable-uploads/4a5d3791-0b0d-4617-8f1d-55991d16baf2.png" />
  <link rel="apple-touch-icon" href="/lovable-uploads/4a5d3791-0b0d-4617-8f1d-55991d16baf2.png" />
  <link rel="manifest" href="/manifest.json" />
  <meta name="theme-color" content="#1a8917" />
  <script>
    // CropGenius PWA Control - Capture install prompt
    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register("/service-worker.js");
    }

    // Capture and store the beforeinstallprompt event
    let deferredPrompt;
    window.addEventListener("beforeinstallprompt", (e) => {
      console.log('ðŸ”¥ [PWA] BeforeInstallPrompt event captured');
      e.preventDefault();
      deferredPrompt = e;
      
      // Store for React component to access
      window.deferredPrompt = e;
      
      // Dispatch custom event for React to listen to
      window.dispatchEvent(new CustomEvent('pwapromptavailable', { detail: e }));
    });

    // Track successful installation
    window.addEventListener("appinstalled", () => {
      console.log('ðŸš€ [PWA] CropGenius installed successfully');
      localStorage.setItem("cg_installed", "true");
      deferredPrompt = null;
      window.deferredPrompt = null;
    });
  </script>
</head>

<body>
  <div id="root"></div>
  <script type="module" src="/src/main.tsx"></script>
</body>

</html>
