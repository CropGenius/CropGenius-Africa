
<!doctype html>
<html lang="en">

<head>
    <title>Code coverage report for CROPGENIUS-main/src/agents/AIFarmPlanAgent.ts</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../../../prettify.css" />
    <link rel="stylesheet" href="../../../base.css" />
    <link rel="shortcut icon" type="image/x-icon" href="../../../favicon.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../../../sort-arrow-sprite.png);
        }
    </style>
</head>
    
<body>
<div class='wrapper'>
    <div class='pad1'>
        <h1><a href="../../../index.html">All files</a> / <a href="index.html">CROPGENIUS-main/src/agents</a> AIFarmPlanAgent.ts</h1>
        <div class='clearfix'>
            
            <div class='fl pad1y space-right2'>
                <span class="strong">0% </span>
                <span class="quiet">Statements</span>
                <span class='fraction'>0/97</span>
            </div>
        
            
            <div class='fl pad1y space-right2'>
                <span class="strong">0% </span>
                <span class="quiet">Branches</span>
                <span class='fraction'>0/1</span>
            </div>
        
            
            <div class='fl pad1y space-right2'>
                <span class="strong">0% </span>
                <span class="quiet">Functions</span>
                <span class='fraction'>0/1</span>
            </div>
        
            
            <div class='fl pad1y space-right2'>
                <span class="strong">0% </span>
                <span class="quiet">Lines</span>
                <span class='fraction'>0/97</span>
            </div>
        
            
        </div>
        <p class="quiet">
            Press <em>n</em> or <em>j</em> to go to the next uncovered block, <em>b</em>, <em>p</em> or <em>k</em> for the previous block.
        </p>
        <template id="filterTemplate">
            <div class="quiet">
                Filter:
                <input type="search" id="fileSearch">
            </div>
        </template>
    </div>
    <div class='status-line low'></div>
    <pre><table class="coverage">
<tr><td class="line-count quiet"><a name='L1'></a><a href='#L1'>1</a>
<a name='L2'></a><a href='#L2'>2</a>
<a name='L3'></a><a href='#L3'>3</a>
<a name='L4'></a><a href='#L4'>4</a>
<a name='L5'></a><a href='#L5'>5</a>
<a name='L6'></a><a href='#L6'>6</a>
<a name='L7'></a><a href='#L7'>7</a>
<a name='L8'></a><a href='#L8'>8</a>
<a name='L9'></a><a href='#L9'>9</a>
<a name='L10'></a><a href='#L10'>10</a>
<a name='L11'></a><a href='#L11'>11</a>
<a name='L12'></a><a href='#L12'>12</a>
<a name='L13'></a><a href='#L13'>13</a>
<a name='L14'></a><a href='#L14'>14</a>
<a name='L15'></a><a href='#L15'>15</a>
<a name='L16'></a><a href='#L16'>16</a>
<a name='L17'></a><a href='#L17'>17</a>
<a name='L18'></a><a href='#L18'>18</a>
<a name='L19'></a><a href='#L19'>19</a>
<a name='L20'></a><a href='#L20'>20</a>
<a name='L21'></a><a href='#L21'>21</a>
<a name='L22'></a><a href='#L22'>22</a>
<a name='L23'></a><a href='#L23'>23</a>
<a name='L24'></a><a href='#L24'>24</a>
<a name='L25'></a><a href='#L25'>25</a>
<a name='L26'></a><a href='#L26'>26</a>
<a name='L27'></a><a href='#L27'>27</a>
<a name='L28'></a><a href='#L28'>28</a>
<a name='L29'></a><a href='#L29'>29</a>
<a name='L30'></a><a href='#L30'>30</a>
<a name='L31'></a><a href='#L31'>31</a>
<a name='L32'></a><a href='#L32'>32</a>
<a name='L33'></a><a href='#L33'>33</a>
<a name='L34'></a><a href='#L34'>34</a>
<a name='L35'></a><a href='#L35'>35</a>
<a name='L36'></a><a href='#L36'>36</a>
<a name='L37'></a><a href='#L37'>37</a>
<a name='L38'></a><a href='#L38'>38</a>
<a name='L39'></a><a href='#L39'>39</a>
<a name='L40'></a><a href='#L40'>40</a>
<a name='L41'></a><a href='#L41'>41</a>
<a name='L42'></a><a href='#L42'>42</a>
<a name='L43'></a><a href='#L43'>43</a>
<a name='L44'></a><a href='#L44'>44</a>
<a name='L45'></a><a href='#L45'>45</a>
<a name='L46'></a><a href='#L46'>46</a>
<a name='L47'></a><a href='#L47'>47</a>
<a name='L48'></a><a href='#L48'>48</a>
<a name='L49'></a><a href='#L49'>49</a>
<a name='L50'></a><a href='#L50'>50</a>
<a name='L51'></a><a href='#L51'>51</a>
<a name='L52'></a><a href='#L52'>52</a>
<a name='L53'></a><a href='#L53'>53</a>
<a name='L54'></a><a href='#L54'>54</a>
<a name='L55'></a><a href='#L55'>55</a>
<a name='L56'></a><a href='#L56'>56</a>
<a name='L57'></a><a href='#L57'>57</a>
<a name='L58'></a><a href='#L58'>58</a>
<a name='L59'></a><a href='#L59'>59</a>
<a name='L60'></a><a href='#L60'>60</a>
<a name='L61'></a><a href='#L61'>61</a>
<a name='L62'></a><a href='#L62'>62</a>
<a name='L63'></a><a href='#L63'>63</a>
<a name='L64'></a><a href='#L64'>64</a>
<a name='L65'></a><a href='#L65'>65</a>
<a name='L66'></a><a href='#L66'>66</a>
<a name='L67'></a><a href='#L67'>67</a>
<a name='L68'></a><a href='#L68'>68</a>
<a name='L69'></a><a href='#L69'>69</a>
<a name='L70'></a><a href='#L70'>70</a>
<a name='L71'></a><a href='#L71'>71</a>
<a name='L72'></a><a href='#L72'>72</a>
<a name='L73'></a><a href='#L73'>73</a>
<a name='L74'></a><a href='#L74'>74</a>
<a name='L75'></a><a href='#L75'>75</a>
<a name='L76'></a><a href='#L76'>76</a>
<a name='L77'></a><a href='#L77'>77</a>
<a name='L78'></a><a href='#L78'>78</a>
<a name='L79'></a><a href='#L79'>79</a>
<a name='L80'></a><a href='#L80'>80</a>
<a name='L81'></a><a href='#L81'>81</a>
<a name='L82'></a><a href='#L82'>82</a>
<a name='L83'></a><a href='#L83'>83</a>
<a name='L84'></a><a href='#L84'>84</a>
<a name='L85'></a><a href='#L85'>85</a>
<a name='L86'></a><a href='#L86'>86</a>
<a name='L87'></a><a href='#L87'>87</a>
<a name='L88'></a><a href='#L88'>88</a>
<a name='L89'></a><a href='#L89'>89</a>
<a name='L90'></a><a href='#L90'>90</a>
<a name='L91'></a><a href='#L91'>91</a>
<a name='L92'></a><a href='#L92'>92</a>
<a name='L93'></a><a href='#L93'>93</a>
<a name='L94'></a><a href='#L94'>94</a>
<a name='L95'></a><a href='#L95'>95</a>
<a name='L96'></a><a href='#L96'>96</a>
<a name='L97'></a><a href='#L97'>97</a>
<a name='L98'></a><a href='#L98'>98</a>
<a name='L99'></a><a href='#L99'>99</a>
<a name='L100'></a><a href='#L100'>100</a>
<a name='L101'></a><a href='#L101'>101</a>
<a name='L102'></a><a href='#L102'>102</a>
<a name='L103'></a><a href='#L103'>103</a>
<a name='L104'></a><a href='#L104'>104</a>
<a name='L105'></a><a href='#L105'>105</a>
<a name='L106'></a><a href='#L106'>106</a>
<a name='L107'></a><a href='#L107'>107</a>
<a name='L108'></a><a href='#L108'>108</a>
<a name='L109'></a><a href='#L109'>109</a>
<a name='L110'></a><a href='#L110'>110</a>
<a name='L111'></a><a href='#L111'>111</a>
<a name='L112'></a><a href='#L112'>112</a>
<a name='L113'></a><a href='#L113'>113</a>
<a name='L114'></a><a href='#L114'>114</a>
<a name='L115'></a><a href='#L115'>115</a>
<a name='L116'></a><a href='#L116'>116</a>
<a name='L117'></a><a href='#L117'>117</a>
<a name='L118'></a><a href='#L118'>118</a>
<a name='L119'></a><a href='#L119'>119</a>
<a name='L120'></a><a href='#L120'>120</a>
<a name='L121'></a><a href='#L121'>121</a>
<a name='L122'></a><a href='#L122'>122</a>
<a name='L123'></a><a href='#L123'>123</a>
<a name='L124'></a><a href='#L124'>124</a>
<a name='L125'></a><a href='#L125'>125</a>
<a name='L126'></a><a href='#L126'>126</a>
<a name='L127'></a><a href='#L127'>127</a>
<a name='L128'></a><a href='#L128'>128</a>
<a name='L129'></a><a href='#L129'>129</a>
<a name='L130'></a><a href='#L130'>130</a>
<a name='L131'></a><a href='#L131'>131</a>
<a name='L132'></a><a href='#L132'>132</a>
<a name='L133'></a><a href='#L133'>133</a>
<a name='L134'></a><a href='#L134'>134</a>
<a name='L135'></a><a href='#L135'>135</a>
<a name='L136'></a><a href='#L136'>136</a>
<a name='L137'></a><a href='#L137'>137</a>
<a name='L138'></a><a href='#L138'>138</a>
<a name='L139'></a><a href='#L139'>139</a>
<a name='L140'></a><a href='#L140'>140</a>
<a name='L141'></a><a href='#L141'>141</a>
<a name='L142'></a><a href='#L142'>142</a>
<a name='L143'></a><a href='#L143'>143</a>
<a name='L144'></a><a href='#L144'>144</a>
<a name='L145'></a><a href='#L145'>145</a>
<a name='L146'></a><a href='#L146'>146</a>
<a name='L147'></a><a href='#L147'>147</a>
<a name='L148'></a><a href='#L148'>148</a>
<a name='L149'></a><a href='#L149'>149</a>
<a name='L150'></a><a href='#L150'>150</a>
<a name='L151'></a><a href='#L151'>151</a>
<a name='L152'></a><a href='#L152'>152</a>
<a name='L153'></a><a href='#L153'>153</a>
<a name='L154'></a><a href='#L154'>154</a>
<a name='L155'></a><a href='#L155'>155</a>
<a name='L156'></a><a href='#L156'>156</a>
<a name='L157'></a><a href='#L157'>157</a>
<a name='L158'></a><a href='#L158'>158</a>
<a name='L159'></a><a href='#L159'>159</a>
<a name='L160'></a><a href='#L160'>160</a>
<a name='L161'></a><a href='#L161'>161</a>
<a name='L162'></a><a href='#L162'>162</a>
<a name='L163'></a><a href='#L163'>163</a>
<a name='L164'></a><a href='#L164'>164</a>
<a name='L165'></a><a href='#L165'>165</a>
<a name='L166'></a><a href='#L166'>166</a>
<a name='L167'></a><a href='#L167'>167</a>
<a name='L168'></a><a href='#L168'>168</a>
<a name='L169'></a><a href='#L169'>169</a>
<a name='L170'></a><a href='#L170'>170</a>
<a name='L171'></a><a href='#L171'>171</a>
<a name='L172'></a><a href='#L172'>172</a>
<a name='L173'></a><a href='#L173'>173</a>
<a name='L174'></a><a href='#L174'>174</a>
<a name='L175'></a><a href='#L175'>175</a>
<a name='L176'></a><a href='#L176'>176</a>
<a name='L177'></a><a href='#L177'>177</a>
<a name='L178'></a><a href='#L178'>178</a>
<a name='L179'></a><a href='#L179'>179</a>
<a name='L180'></a><a href='#L180'>180</a>
<a name='L181'></a><a href='#L181'>181</a>
<a name='L182'></a><a href='#L182'>182</a>
<a name='L183'></a><a href='#L183'>183</a>
<a name='L184'></a><a href='#L184'>184</a>
<a name='L185'></a><a href='#L185'>185</a>
<a name='L186'></a><a href='#L186'>186</a>
<a name='L187'></a><a href='#L187'>187</a>
<a name='L188'></a><a href='#L188'>188</a>
<a name='L189'></a><a href='#L189'>189</a>
<a name='L190'></a><a href='#L190'>190</a>
<a name='L191'></a><a href='#L191'>191</a>
<a name='L192'></a><a href='#L192'>192</a>
<a name='L193'></a><a href='#L193'>193</a>
<a name='L194'></a><a href='#L194'>194</a>
<a name='L195'></a><a href='#L195'>195</a>
<a name='L196'></a><a href='#L196'>196</a>
<a name='L197'></a><a href='#L197'>197</a>
<a name='L198'></a><a href='#L198'>198</a>
<a name='L199'></a><a href='#L199'>199</a>
<a name='L200'></a><a href='#L200'>200</a>
<a name='L201'></a><a href='#L201'>201</a></td><td class="line-coverage quiet"><span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js"><span class="cstat-no" title="statement not covered" >// src/agents/AIFarmPlanAgent.ts<span class="fstat-no" title="function not covered" ><span class="branch-0 cbranch-no" title="branch not covered" ></span></span></span>
&nbsp;
/**
 * @file AIFarmPlanAgent.ts
 * @description Agent for generating AI-driven farm plans and tasks using Gemini.
 */
&nbsp;
import { supabase } from '../services/supabaseClient';
import { ProcessedCurrentWeather, ProcessedForecastItem } from './WeatherAgent';
import { MarketListing } from './SmartMarketAgent'; // For market context
&nbsp;
<span class="cstat-no" title="statement not covered" >const GEMINI_API_KEY = import.meta.env.VITE_GEMINI_API_KEY;</span>
<span class="cstat-no" title="statement not covered" >const GEMINI_API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=${GEMINI_API_KEY}`;</span>
&nbsp;
// --- Interface Definitions ---
&nbsp;
export interface FarmTask {
  id?: string; // Optional: if stored and retrieved from DB
  title: string;
  description: string;
  priority: 'High' | 'Medium' | 'Low';
  dueDate?: string; // ISO date string
  category: 'Planting' | 'Irrigation' | 'Fertilization' | 'PestControl' | 'Harvesting' | 'SoilPreparation' | 'Monitoring' | 'Other';
  status?: 'Pending' | 'InProgress' | 'Completed';
  assignedTo?: string; // Optional: user ID or name
  farmId?: string; // To link task to a farm
  fieldId?: string; // Optional: to link task to a specific field
  userId?: string; // User who owns or is assigned the task
}
&nbsp;
export interface FarmPlanInput {
  farmId: string;
  userId: string;
  cropTypes: string[]; // e.g., ['Maize', 'Beans']
  currentSeason: string; // e.g., 'Long Rains 2024', 'Short Rains 2023'
  farmSizeAcres?: number;
  soilData?: any; // Simplified for now, could be { ph: number, organicMatter: number, ... }
  weatherContext?: {
    current?: ProcessedCurrentWeather | null;
    forecast?: ProcessedForecastItem[] | null;
  };
  marketContext?: {
    relevantListings?: MarketListing[];
    // Future: priceTrends, demandSignals
  };
  userGoals?: string[]; // e.g., ['Maximize yield', 'Improve soil health', 'Minimize water usage']
  // Add other relevant farm-specific data
}
&nbsp;
export interface FarmPlanOutput {
  planSummary: string;
  tasks: FarmTask[];
  suggestedPlantingDates?: Record&lt;string, string&gt;; // cropType: ISO date string
  resourceWarnings?: string[]; // e.g., ['Low water availability expected', 'High pest pressure for Maize']
  rawGeminiResponse?: any; // For debugging and audit
}
&nbsp;
// --- Helper: Build Prompt for Gemini --- 
<span class="cstat-no" title="statement not covered" >const buildFarmPlanPrompt = (input: FarmPlanInput): string =&gt; {</span>
<span class="cstat-no" title="statement not covered" >  let prompt = `As an expert agronomist and farm manager for a farm in East Africa, generate a comprehensive and actionable farm plan.</span>
<span class="cstat-no" title="statement not covered" >  Farm ID: ${input.farmId}\nUser ID: ${input.userId}\nCrop(s) of Interest: ${input.cropTypes.join(', ')}\nCurrent Season: ${input.currentSeason}\n`;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >  if (input.farmSizeAcres) prompt += `Farm Size: ${input.farmSizeAcres} acres\n`;</span>
<span class="cstat-no" title="statement not covered" >  if (input.userGoals &amp;&amp; input.userGoals.length &gt; 0) prompt += `User Goals: ${input.userGoals.join(', ')}\n`;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >  if (input.soilData) {</span>
<span class="cstat-no" title="statement not covered" >    prompt += `Soil Data: ${JSON.stringify(input.soilData)}\n`;</span>
<span class="cstat-no" title="statement not covered" >  }</span>
<span class="cstat-no" title="statement not covered" >  if (input.weatherContext?.current) {</span>
<span class="cstat-no" title="statement not covered" >    prompt += `Current Weather: ${input.weatherContext.current.weatherDescription}, Temp: ${input.weatherContext.current.temperatureCelsius}°C\n`;</span>
<span class="cstat-no" title="statement not covered" >  }</span>
<span class="cstat-no" title="statement not covered" >  if (input.weatherContext?.forecast &amp;&amp; input.weatherContext.forecast.length &gt; 0) {</span>
<span class="cstat-no" title="statement not covered" >    const nextForecast = input.weatherContext.forecast[0];</span>
<span class="cstat-no" title="statement not covered" >    prompt += `Next Day Forecast: ${nextForecast.weatherDescription}, Max Temp: ${nextForecast.tempMaxCelsius}°C, Min Temp: ${nextForecast.tempMinCelsius}°C\n`;</span>
<span class="cstat-no" title="statement not covered" >  }</span>
<span class="cstat-no" title="statement not covered" >  if (input.marketContext?.relevantListings &amp;&amp; input.marketContext.relevantListings.length &gt; 0) {</span>
<span class="cstat-no" title="statement not covered" >    const topListing = input.marketContext.relevantListings[0];</span>
    // Fixed the property names to match the MarketListing interface
<span class="cstat-no" title="statement not covered" >    prompt += `Market Context Example (${topListing.crop_name}): Price ${topListing.currency} ${topListing.price}/${topListing.unit || 'unit'}, Location ${topListing.location} recorded on ${topListing.date_recorded}.\n`;</span>
<span class="cstat-no" title="statement not covered" >  }</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >  prompt += `\nPlease provide:</span>
1. A brief Plan Summary (2-3 sentences).
2. A list of prioritized Tasks for the next 1-2 weeks. For each task, specify: title, description, priority (High, Medium, Low), category (e.g., Planting, Irrigation, PestControl, SoilPreparation, Monitoring), and an estimated due date if applicable.
3. Suggested Planting Dates for each crop, if it's planting season.
4. Any Resource Warnings based on the provided context (e.g., water, pest pressure).
&nbsp;
Format the tasks as a JSON array of objects. Each task object should have 'title', 'description', 'priority', 'category', and 'dueDate' (optional ISO string) keys.
Example Task JSON: 
[{"title": "Prepare Field A for Maize", "description": "Clear debris and till the soil.", "priority": "High", "category": "SoilPreparation", "dueDate": "2024-03-15"}]
Ensure the entire response is a single JSON object with keys: 'planSummary', 'tasks' (JSON array as described), 'suggestedPlantingDates' (object), and 'resourceWarnings' (array of strings).
`;
<span class="cstat-no" title="statement not covered" >  return prompt;</span>
<span class="cstat-no" title="statement not covered" >};</span>
&nbsp;
// --- Core Agent Functions ---
&nbsp;
/**
 * Generates a farm plan using Gemini API.
 */
<span class="cstat-no" title="statement not covered" >export const generateFarmPlan = async (</span>
<span class="cstat-no" title="statement not covered" >  input: FarmPlanInput</span>
<span class="cstat-no" title="statement not covered" >): Promise&lt;FarmPlanOutput&gt; =&gt; {</span>
<span class="cstat-no" title="statement not covered" >  if (!GEMINI_API_KEY) {</span>
<span class="cstat-no" title="statement not covered" >    console.error('Gemini API key is not configured.');</span>
<span class="cstat-no" title="statement not covered" >    throw new Error('Gemini API key is missing.');</span>
<span class="cstat-no" title="statement not covered" >  }</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >  const prompt = buildFarmPlanPrompt(input);</span>
<span class="cstat-no" title="statement not covered" >  console.log('Generating Farm Plan with Gemini. Prompt:', prompt); </span>
&nbsp;
<span class="cstat-no" title="statement not covered" >  const requestPayload = {</span>
<span class="cstat-no" title="statement not covered" >    contents: [{ parts: [{ text: prompt }] }],</span>
    // Optional: Add generationConfig for temperature, topK, topP etc.
    // generationConfig: {
    //   temperature: 0.7,
    //   topK: 40,
    //   topP: 0.95,
    //   maxOutputTokens: 2048, // Adjust as needed
    // },
    // Optional: Add safetySettings
    // safetySettings: [ { category: 'HARM_CATEGORY_DANGEROUS_CONTENT', threshold: 'BLOCK_NONE'} ]
<span class="cstat-no" title="statement not covered" >  };</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >  try {</span>
<span class="cstat-no" title="statement not covered" >    const response = await fetch(GEMINI_API_URL, {</span>
<span class="cstat-no" title="statement not covered" >      method: 'POST',</span>
<span class="cstat-no" title="statement not covered" >      headers: {</span>
<span class="cstat-no" title="statement not covered" >        'Content-Type': 'application/json',</span>
<span class="cstat-no" title="statement not covered" >      },</span>
<span class="cstat-no" title="statement not covered" >      body: JSON.stringify(requestPayload),</span>
<span class="cstat-no" title="statement not covered" >    });</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (!response.ok) {</span>
<span class="cstat-no" title="statement not covered" >      const errorData = await response.json().catch(() =&gt; null); // Try to parse error, but don't fail if it's not JSON</span>
<span class="cstat-no" title="statement not covered" >      console.error('Gemini API Error Response:', errorData);</span>
<span class="cstat-no" title="statement not covered" >      const errorMessage = errorData?.error?.message || response.statusText || 'Gemini API request failed';</span>
<span class="cstat-no" title="statement not covered" >      throw new Error(`Gemini API request failed: ${response.status} - ${errorMessage}`);</span>
<span class="cstat-no" title="statement not covered" >    }</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    const geminiResponse = await response.json();</span>
<span class="cstat-no" title="statement not covered" >    const rawTextResponse = geminiResponse.candidates?.[0]?.content?.parts?.[0]?.text;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (!rawTextResponse) {</span>
<span class="cstat-no" title="statement not covered" >      console.error('No text response from Gemini:', geminiResponse);</span>
<span class="cstat-no" title="statement not covered" >      throw new Error('Failed to get a valid response from Gemini for farm plan.');</span>
<span class="cstat-no" title="statement not covered" >    }</span>
&nbsp;
    // Attempt to parse the JSON from the response
    // Gemini should be prompted to return a single JSON object as specified.
<span class="cstat-no" title="statement not covered" >    try {</span>
<span class="cstat-no" title="statement not covered" >      const parsedResponse: FarmPlanOutput = JSON.parse(rawTextResponse);</span>
      // Validate structure a bit
<span class="cstat-no" title="statement not covered" >      if (!parsedResponse.planSummary || !Array.isArray(parsedResponse.tasks)) {</span>
<span class="cstat-no" title="statement not covered" >        console.error('Parsed Gemini response lacks expected structure:', parsedResponse);</span>
<span class="cstat-no" title="statement not covered" >        throw new Error('Gemini response JSON structure is invalid.');</span>
<span class="cstat-no" title="statement not covered" >      }</span>
<span class="cstat-no" title="statement not covered" >      return { ...parsedResponse, rawGeminiResponse: geminiResponse };</span>
<span class="cstat-no" title="statement not covered" >    } catch (parseError) {</span>
<span class="cstat-no" title="statement not covered" >      console.error('Failed to parse Gemini JSON response for farm plan:', parseError);</span>
<span class="cstat-no" title="statement not covered" >      console.error('Raw Gemini text response was:', rawTextResponse);</span>
      // Fallback or more sophisticated error handling might be needed here.
      // For now, re-throw, or try to extract parts if possible.
<span class="cstat-no" title="statement not covered" >      throw new Error('Failed to parse farm plan JSON from Gemini response.');</span>
<span class="cstat-no" title="statement not covered" >    }</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >  } catch (error) {</span>
<span class="cstat-no" title="statement not covered" >    console.error('Error in generateFarmPlan:', error);</span>
<span class="cstat-no" title="statement not covered" >    throw error;</span>
<span class="cstat-no" title="statement not covered" >  }</span>
<span class="cstat-no" title="statement not covered" >};</span>
&nbsp;
// --- Placeholder for saving plan/tasks to Supabase ---
<span class="cstat-no" title="statement not covered" >export const saveFarmPlanAndTasks = async (plan: FarmPlanOutput, input: FarmPlanInput): Promise&lt;void&gt; =&gt; {</span>
<span class="cstat-no" title="statement not covered" >  console.log('Attempting to save farm plan and tasks for farm:', input.farmId, 'user:', input.userId);</span>
  // 1. Save the overall plan (if you have a farm_plans table)
  // 2. Save individual tasks to the 'tasks' table
<span class="cstat-no" title="statement not covered" >  if (plan.tasks &amp;&amp; plan.tasks.length &gt; 0) {</span>
<span class="cstat-no" title="statement not covered" >    const tasksToInsert = plan.tasks.map(task =&gt; ({</span>
<span class="cstat-no" title="statement not covered" >      title: task.title,</span>
<span class="cstat-no" title="statement not covered" >      description: task.description,</span>
<span class="cstat-no" title="statement not covered" >      priority: task.priority === 'High' ? 3 : task.priority === 'Medium' ? 2 : 1, // Convert to number (1-3)</span>
<span class="cstat-no" title="statement not covered" >      due_date: task.dueDate,</span>
<span class="cstat-no" title="statement not covered" >      user_id: input.userId,</span>
<span class="cstat-no" title="statement not covered" >      status: task.status?.toLowerCase().replace('inprogress', 'in_progress').replace('pending', 'pending').replace('completed', 'completed') as "pending" | "in_progress" | "completed" || 'pending',</span>
<span class="cstat-no" title="statement not covered" >      field_id: task.fieldId || input.farmId,</span>
<span class="cstat-no" title="statement not covered" >    }));</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    const { data, error } = await supabase.from('tasks').insert(tasksToInsert).select();</span>
<span class="cstat-no" title="statement not covered" >    if (error) {</span>
<span class="cstat-no" title="statement not covered" >      console.error('Supabase error saving tasks:', error);</span>
<span class="cstat-no" title="statement not covered" >      throw error;</span>
<span class="cstat-no" title="statement not covered" >    }</span>
<span class="cstat-no" title="statement not covered" >    console.log('Tasks saved to Supabase:', data);</span>
<span class="cstat-no" title="statement not covered" >  } else {</span>
<span class="cstat-no" title="statement not covered" >    console.log('No tasks to save for this plan.');</span>
<span class="cstat-no" title="statement not covered" >  }</span>
  // Add logic for saving plan summary if needed
<span class="cstat-no" title="statement not covered" >};</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >console.log('AIFarmPlanAgent.ts loaded');</span></pre></td></tr></table></pre>

                <div class='push'></div><!-- for sticky footer -->
            </div><!-- /wrapper -->
            <div class='footer quiet pad2 space-top1 center small'>
                Code coverage generated by
                <a href="https://istanbul.js.org/" target="_blank" rel="noopener noreferrer">istanbul</a>
                at 2025-08-29T15:17:08.225Z
            </div>
        <script src="../../../prettify.js"></script>
        <script>
            window.onload = function () {
                prettyPrint();
            };
        </script>
        <script src="../../../sorter.js"></script>
        <script src="../../../block-navigation.js"></script>
    </body>
</html>
    